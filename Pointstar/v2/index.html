<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Techstar Pro</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="http://lcnjoel.com/css/standard.css">
</head>
<body>
    <nav class="nav">
        <h1>
            Tech Star
        </h1>
    </nav>
    <nav class="nav selected-info">
        <h1>
            Selected
        </h1>
        <input type="text" class="selinp" placeholder="Enter Custom point value.">
            <div class="scroll-items">
                <div class="s-item">
                    <img src="/v2/image.png" alt="pfp" class="pfp">
                    <span>Tyler</span>
                </div>
            </div>
            <div class="close" id="selecting-close" data-toggle=".selected-info" data-togglecl="selecting">
                <img src="x.png" alt="x" class="mini-pfp">
            </div>
            
    </nav>
    <nav class="nav-i">
        <h1>
            Tech Star
        </h1>
    </nav>
    <div class="cont">
        <nav class="side-nav">
            <h5>Navigation</h5>
            <ul>
                <li class="sel">Admin config.</li>
                <li>Shop</li>
                <li>Leaderboard</li>
            </ul>
        </nav>
        <div class="admin-config">
            <div class="viewer dn">
                <div class="v-top">
                    <span>Class</span>
                    <div class="close" data-toggle=".viewer" data-togglecl="dn">
                        <img src="x.png" alt="x" class="mini-pfp">
                    </div>
                </div>
                <div class="students" id="js-student-classes"></div>
            </div>
            <div class="search">
                <input type="text" placeholder="Search students by name or ID" id="search">
                <div id="results"></div>
            </div>
            <div class="students">
                <div class="student dn ">
                    <div class="blocket">
                        <input type="checkbox" name="" id="">
                    </div>
                    <div class="blocket">
                        <img src="image.png" alt="pfp" class="base-pfp">
                    </div>
                    <div class="st-name">
                        <span>Joel Mulonde</span>
                        <span>38711</span>
                    </div>
                    <button class="plus">
                        +5
                    </button>
                    <button class="plus">
                        +10
                    </button>
                </div>
            </div>

            <div class="manage mt-5">
                <div class="class">
                    <span>Create a class</span>
                </div>
            </div>
            <h3 class="mt-5">Classes</h3>
            <div class="classes-sec">
                <div class="class" id="wh">
                    <span>
                        World History 7th
                    </span>
                    <span>Larry Mylander - 173 points</span>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    const students = [
    { name: 'Joel Mulonde', id: 31733 },
    { name: 'Nicole Denson', id: 45371 },
    { name: 'Tyler Dickson', id: 91021 },
    { name: 'Jerry Cruz', id: 22013 },
    { name: 'John sow', id: 10101 },
    { name: 'Johny Walker', id: 10501 },
    { name: 'Jane Smith', id: 10102 },
    { name: 'Sam Brown', id: 10103 },
    { name: 'Alice Green', id: 10104 },
    { name: 'Michael Johnson', id: 10105 },
    { name: 'Linda White', id: 10106 },
    { name: 'David Black', id: 10107 },
    { name: 'Patricia Miller', id: 10108 },
    { name: 'Thomas shoyt', id: 10109 },
    { name: 'Sarah Clark', id: 10110 },
    { name: 'James Lewis Hamil', id: 20713 },
    { name: 'Elizabeth Young', id: 10112 },
    { name: 'Richard Hall', id: 10113 },
    { name: 'Helen Allen', id: 10114 },
    { name: 'William King', id: 10115 },
    { name: 'Barbara Scott', id: 10116 },
    { name: 'Charles Adams', id: 10117 },
    { name: 'Deborah Nelson', id: 10118 },
    { name: 'Joseph Carter', id: 10119 },
    { name: 'Nancy Mitchell', id: 10120 },
    { name: 'Gary Perez', id: 10121 },
    { name: 'Megan Roberts', id: 10122 },
    { name: 'Andrew Walker', id: 10123 },
    { name: 'Dorothy Hill', id: 10124 },
    { name: 'Kevin Green', id: 10125 },
    { name: 'Laura Baker', id: 10126 },
    { name: 'Steven Gonzalez', id: 10127 },
    { name: 'Michelle Martinez', id: 10128 },
    { name: 'Edward Harris', id: 10129 },
    { name: 'Kimberly Evans', id: 10130 },
    { name: 'George Thompson', id: 10131 },
    { name: 'Emma White', id: 10132 },
    { name: 'Brian Moore', id: 10133 },
    { name: 'Sandra Taylor', id: 10134 },
    { name: 'Daniel Robinson', id: 10135 },
    { name: 'Amy Lewis', id: 10136 },
    { name: 'Donald Clark', id: 10137 },
    { name: 'Helen Carter', id: 10138 },
    { name: 'Jack Perez', id: 10139 },
    { name: 'Emily Anderson', id: 10140 },
    { name: 'Mark Harris', id: 10141 },
    { name: 'Sophia Green', id: 10142 },
    { name: 'Christopher Scott', id: 10143 },
    { name: 'Olivia Walker', id: 10144 },
    { name: 'Ethan Hill', id: 10145 },
    { name: 'Madison Lee', id: 10146 },
    { name: 'Jacob King', id: 10147 },
    { name: 'Ava Lewis', id: 10148 },
    { name: 'Liam Robinson', id: 10149 },
    { name: 'Isabella Clark', id: 10150 },
    { name: 'Matthew Harris', id: 10151 },
    { name: 'Charlotte Adams', id: 10152 },
    { name: 'Owen Walker', id: 10153 },
    { name: 'Dylan Harris', id: 10252 },
    { name: 'Benjamin White', id: 10253 },
    { name: 'Aiden Harris', id: 10254 },
    { name: 'Lucas Brown', id: 10255 },
    { name: 'Samuel Taylor', id: 10256 },
    { name: 'Madeline White', id: 10257 },
    { name: 'Nathan Brown', id: 10258 },
    { name: 'Olivia Green', id: 10259 },
    { name: 'Daniel Green', id: 10260 },
    { name: 'Caden Brown', id: 10261 },
    { name: 'Charlotte White', id: 10262 },
    { name: 'Nina Clark', id: 10263 },
    { name: 'Ella Lewis', id: 10264 },
    { name: 'Peyton Green', id: 10265 },
    { name: 'Gabriel White', id: 10266 },
    { name: 'Jocelyn King', id: 10267 },
    { name: 'David Brown', id: 10268 },
    { name: 'Evan White', id: 10269 },
    { name: 'Sophie Green', id: 10270 },
    { name: 'Leo Clark', id: 10271 },
    { name: 'Cameron Walker', id: 10272 },
    { name: 'Piper Harris', id: 10273 },
    { name: 'Amos Brown', id: 10274 },
    { name: 'Tanner White', id: 10275 },
    { name: 'Leah Walker', id: 10276 },
    { name: 'Tyler King', id: 10277 },
    { name: 'Lucy White', id: 10278 },
    { name: 'Ella Brown', id: 10279 },
    { name: 'Dylan Brown', id: 10280 },
    { name: 'Ava White', id: 10281 },
    { name: 'Jordan Walker', id: 10282 },
    { name: 'Isaiah Brown', id: 10283 },
    { name: 'Natalie Walker', id: 10284 },
    { name: 'Elijah White', id: 10285 },
    { name: 'Zoe King', id: 10286 },
    { name: 'Sophia White', id: 10287 },
    { name: 'Brianna Walker', id: 10288 },
    { name: 'Maggie Brown', id: 10289 },
    { name: 'Ella Green', id: 10290 },
    { name: 'David King', id: 10291 },
    { name: 'Riley White', id: 10292 },
    { name: 'Liam Brown', id: 10293 },
    { name: 'Lily Walker', id: 10294 },
    { name: 'Addison White', id: 10295 },
    { name: 'Mia Green', id: 10296 },
    { name: 'Eva Brown', id: 10297 },
    { name: 'Sadie Clark', id: 10298 },
    { name: 'Grayson Walker', id: 10299 },
    { name: 'Oliver White', id: 10300 },
    { name: 'Daniel Green', id: 10301 },
    { name: 'Aiden White', id: 10302 },
    { name: 'Maddie King', id: 10303 },
    { name: 'Leo Green', id: 10304 },
    { name: 'Liam Harris', id: 10305 },
    { name: 'Finnley Daxton', id: 20901 },
  { name: 'Soren Blakely', id: 24892 },
  { name: 'Elliot Ralston', id: 16321 },
  { name: 'Kiera Moss', id: 23457 },
  { name: 'Talon Greer', id: 23804 },
  { name: 'Zara Quinlan', id: 18463 },
  { name: 'Xander Bellamy', id: 21478 },
  { name: 'Isla Lennox', id: 14920 },
  { name: 'Dax Mercer', id: 12184 },
  { name: 'Sierra Foster', id: 21735 },
  { name: 'Kendrick Voss', id: 22619 },
  { name: 'Cassidy Knox', id: 17451 },
  { name: 'Levi Trevors', id: 19342 },
  { name: 'Harley Westbrook', id: 12293 },
  { name: 'Dakota Blanchard', id: 24180 },
  { name: 'Rory Preston', id: 13574 },
  { name: 'Orla MacLeod', id: 16850 },
  { name: 'Malcolm Axton', id: 24893 },
  { name: 'Cassian Blake', id: 15628 },
  { name: 'Marley Tempest', id: 19472 },
  { name: 'Ellis Wilder', id: 18563 },
  { name: 'Amara Storm', id: 13327 },
  { name: 'Reagan Calder', id: 24567 },
  { name: 'Juno Avery', id: 23794 },
  { name: 'Julian Kade', id: 19865 },
  { name: 'Vera Kingsley', id: 15436 },
  { name: 'Julia Rodriguez', id: 15436 },
  { name: 'Luca Hawke', id: 21356 },
  { name: 'Mira Kent', id: 20185 },
  { name: 'Rylan West', id: 18350 },
  { name: 'Finley Montgomery', id: 22098 },
  { name: 'Tessa Blackwell', id: 16589 },
  { name: 'Milo Carrington', id: 14237 },
  { name: 'Caden Voss', id: 17729 },
  { name: 'Aubrey Westbrook', id: 16074 },
  { name: 'Quinn Darrow', id: 21647 },
  { name: 'Jules Stark', id: 19072 },
  { name: 'Cleo Knight', id: 23218 },
  { name: 'Theo Collier', id: 24065 },
  { name: 'Orion Lee', id: 17239 },
  { name: 'Eira Harper', id: 20268 },
  { name: 'Paxton Wells', id: 12268 },
  { name: 'Axel Rivers', id: 21273 },
  { name: 'Jasper Quinlan', id: 12948 },
  { name: 'Gwen Daley', id: 23892 },
  { name: 'Dorian Cross', id: 18091 },
  { name: 'Elara Rivers', id: 24386 },
  { name: 'Selene Barrett', id: 19673 },
  { name: 'Zeke Wilder', id: 23462 },
  { name: 'Harper Thorne', id: 17791 },
  { name: 'Mavis Claremont', id: 12970 },
  { name: 'Ivy Rojas', id: 20936 },
  { name: 'Kieran Banks', id: 21708 },
  { name: 'Lucia Fenwick', id: 24659 },
  { name: 'Wren North', id: 16043 },
  { name: 'Dorian Rivers', id: 14792 },
  { name: 'Xandra Maddox', id: 18472 },
  { name: 'Leland Grant', id: 14573 },
  { name: 'Imogen Shaw', id: 21906 },
  { name: 'Cali Foster', id: 22234 },
  { name: 'Zane Solis', id: 13784 }
];

document.addEventListener("DOMContentLoaded", (event) => {
    const searchInput = document.getElementById('search');
const resultsDiv = document.getElementById('results');

let classes = [
    {
        name: 'World History 7th',
        teacher: 'Larry Mylander',
        id: 1001,
        points: 171,
        students: [
            { name: 'Joel Mulonde', id: 31733 },
            { name: 'Nicole Denson', id: 45371 },
    ],
    }
]

let selectedStudents = []

function renderClassses() {
    const classesSec = document.querySelector('.classes-sec')
    classesSec.innerHTML = ''

    classes.forEach(cl => {
        const classDiv = document.createElement('div')
        classDiv.classList.add('class')
        classDiv.id = cl.id + '-class'
        classDiv.innerHTML = `
            <span>${cl.name}</span>
            <span>${cl.teacher} - ${cl.points} points</span>
        `
        classesSec.appendChild(classDiv)
    })
}

renderClassses()

const allClasses = document.querySelectorAll('.class')
allClasses.forEach(cl => {
    cl.addEventListener('click', () => {
        const id = cl.id.split('-')[0]
        viewClass(id)
    })
})

function viewClass(id) {
    // const classDiv = document.getElementById(id + '-class')
    const viewerDiv = document.querySelector('.viewer')
    viewerDiv.classList.toggle('dn')

    const studentsDiv = document.getElementById('js-student-classes')
    const classStudents = classes.find(cl => cl.id === Number(id)).students

    studentsDiv.innerHTML = ''

    classStudents.forEach(student => {
        const studentDiv = document.createElement('div')
        studentDiv.classList.add('student')
        studentDiv.innerHTML = renderStudentHtml(student);
        studentsDiv.appendChild(studentDiv)
    })

}

const allStudentChecks = document.querySelectorAll('#js-student-checker')
allStudentChecks.forEach(checker => {
    checker.addEventListener('click', () => {
        showSelDiv();
        const name = checker.dataset.metaName
        const id = checker.dataset.metaId

        selectedStudents.push({
            name,
            id,
        })
    })
});

function showSelDiv() {
    const selectedNav = document.querySelector('.selected-info')
    selectedNav.classList.toggle('selecting')
    updateSels()
}


function updateSels() {
    const scrollsec = document.querySelector('.scroll-items')

    scrollsec.innerHTML = `
    `

    selectedStudents.forEach(student => {
        const firstName = student.name.split(' ')[0];
        scrollsec.innerHTML += `
             <div class="s-item">
                <img src="image.png" alt="pfp" class="mini-pfp">
                <span>${firstName}</span>
            </div>
        `

    })
    
}

// Listen for input events on the search field
// Listen for input events on the search field
searchInput.addEventListener('input', () => {
    const query = searchInput.value.toLowerCase();
    resultsDiv.innerHTML = ''; // Clear previous results

    // Filter students by name or ID
    const filteredStudents = students.filter(student => {
        return (
            student.name.toLowerCase().includes(query) ||
            student.id.toString().includes(query)
        );
    });

    // Limit the results to the top 6 closest matches
    const topResults = filteredStudents.slice(0, 6);

    // Display results or clear the HTML when no match
    if (topResults.length > 0) {
        topResults.forEach(student => {
            const studentDiv = document.createElement('div');
            studentDiv.classList.add('student');

            studentDiv.innerHTML = renderStudentHtml(student);
            resultsDiv.appendChild(studentDiv);
        });
    } else {
        resultsDiv.textContent = 'No results found'; // Clear content if no match
    }

    // Clear results if search input is empty
    if (searchInput.value === '') {
        resultsDiv.textContent = '';
        resultsDiv.classList.remove('open');
    }

    // Show results if there is a query
    if (searchInput.value !== '') {
        resultsDiv.classList.add('open');
    }

    document.addEventListener("click", (event) => {
  // Check if the click was outside the results div
        if (!resultsDiv.contains(event.target)) {
            resultsDiv.classList.remove('open'); // Hide the div
        }
    });
});

function renderStudentHtml(student) {

    const isSelected = selectedStudents.some(
        selected => selected.id.toString() === student.id.toString()
    );
    const html = `
        <div class="blocket">
                    <input 
                        type="checkbox" 
                        data-meta-name='${student.name}' 
                        data-meta-id='${student.id}' 
                        name="" 
                        id="js-student-checker" 
                        ${isSelected ? 'checked' : ''} 
                    >
                </div>
                <div class="blocket">
                    <img src="image.png" alt="pfp" class="base-pfp">
                </div>
                <div class="st-name blocket">
                    <span>${student.name}</span>
                    <span>${student.id}</span>
                </div>
                <button class="plus">
                    +2
                </button>
                <button class="plus">
                    -2
                </button>
                <div class="blocket">
                    <img src="manage.png" alt="pfp" class="base-pfp st stand_er-invert">
                </div>
                `
    return html
}



const selectedInfoDiv = document.querySelector('.selected-info'); // Ensure this selector exists and is correct

resultsDiv.addEventListener('click', (event) => {
    // Check if the click is on a checkbox
    if (event.target.matches('input[type="checkbox"][data-meta-name]')) {
        const checker = event.target;

        // Get the data attributes from the clicked checkbox
        const name = checker.dataset.metaName;
        const id = checker.dataset.metaId;

        if (checker.checked) {
            // Add the student if checked
            selectedStudents.push({ name, id });
        } else {
            // Remove the student if unchecked
            const index = selectedStudents.findIndex(student => student.id === id);
            if (index !== -1) {
                selectedStudents.splice(index, 1);
            }
        }

        // Toggle the `.selecting` class on the `.selected-info` div
        if (selectedStudents.length > 0) {
            selectedInfoDiv.classList.add('selecting');
        } else {
            selectedInfoDiv.classList.remove('selecting');
        }

        // Debugging: Check the selected students array in the console
        console.log("Selected Students:", selectedStudents);

        updateSels()
    }
});

const allTargets = document.querySelectorAll('[data-toggle]')

const closeDiv = document.getElementById('selecting-close')
closeDiv.addEventListener('click', () => {
    selectedStudents.length = []
})

allTargets.forEach(item => {
    item.addEventListener('click', () => {
        const classToC = item.dataset.togglecl; // 'selected'
        const divToC = document.querySelector(item.dataset.toggle); // Selects '.selected-info'
        
        // Ensure divToC is valid before trying to toggle class
        if (divToC) {
            divToC.classList.toggle(classToC); // Toggles 'selected' class on .selected-info
        }
    })
})

});
</script>
</html>